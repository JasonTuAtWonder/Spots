## Unity version

The project uses Unity 2020.3.14f1.

## Discussion Points

### Design patterns

The `Scripts/` directory roughly follows a Model-View-Presenter (MVP) design pattern:

<img src="./Images/project_structure.png" alt="Model-View-Presenter" width="600" />

1. **Models**. The game's data models. These are pure data containers, and should contain no application logic.
2. **Presenters**. These are `MonoBehaviours` that serve as "controllers". They contain the presentational logic of the game.
3. **Views**. These are the GameObjects you see in the Scene Hierarchy.
4. **Services**. These are also `MonoBehaviours`, but do not handle presentational logic. Instead, they provide access to side effects, such as triggering a sound effect, or instantiating a prefab.

For the purpose of dependency injection, I rely on Unity's built-in serialization. Dependencies are dragged into the `public` fields of each `MonoBehaviour`, and are enforced with a `[NotNull]` attribute that warns me about missing dependencies at build time.

This has the benefit of bypassing the need to write many `GetComponent<>()` calls to grab dependencies, and makes it easier to unit test individual `MonoBehaviours` if needed. You simply pass in (or "inject") a different set of dependencies.

### Incomplete sound effects

I could only grab the first 13 note sound effects from the original game, as well as the square chime sound effect. I assume there are more.

### Rectangle handling

In the original game, rectangles will trigger a similar chime sound as when a square is detected. However, I don't perform any special handling of rectangles, and simply treat it as a normal sequence of connected dots.

### Coroutines vs. `async/await`

This project solely uses coroutines (in a "fire and forget" fashion).

I am aware of `async/await` (having used it extensively in JavaScript and TypeScript), but haven't felt a need to use `async/await` on this project.

It seems that `async/await` also [doesn't work in WebGL builds](http://www.youtube.com/watch?v=WY-mk-ZGAq8&t=15m10s). However, upon further research, it seems [UniTask](https://www.reddit.com/r/Unity3D/comments/q4ivhh/async_await_is_coroutines_hot_sister_a_quick_intro/hfz5d8p/) solves many of the shortcomings of C#'s built-in `Task`.

### WebGL build

This project exports a WebGL build, which you can see in [`WebGLBuild/`](./WebGLBuild).

I upload the contents of the WebGL build using [Vercel](https://vercel.com/), and you can play the game at https://spots-nucleartide.vercel.app/.

### Audio clicking in WebGL

You can hear an annoying audio `*click*` sound when the first sound effect plays in the WebGL build.

Apparently, this is due to Google Chrome preventing the web browser's `AudioContext` from being "resumed", at least until the user interacts with the web browser.

To work around this issue, I modify the `index.html` generated by Unity3D, and add a small event handler in [`WebGLBuild/index.html`](./WebGLBuild/index.html) that prompts the user to click `Play Game` to load the game.

Upon clicking the `Play Game` button, the `AudioContext` will be resumed, and you will hear that annoying audio `*click*` upon *loading* the game – not when the game plays the first sound effect.

I think this leads to a nicer in-game experience.

### `Is Test Mode` flag

When developing the game in the Unity editor, the enabled `Is Test Mode` flag inside `Assets/Configuration/Game Configuration.asset` means that only 2 colors will be used for populating the game board.

While useful for making it easy to match squares, you can toggle this behavior by simply unchecking the `Is Test Mode` flag, and re-running "Play" in the Unity editor.

### Make everything `static`

In [`Assets/Scripts/Presenters/ProgressBarPresenter.cs`](./Assets/Scripts/Presenters/ProgressBarPresenter.cs), I started to experiment with making all methods `static`.

I really enjoyed this approach since it decouples logic from state. It makes it easier to test individual functions by making your function's dependencies explicit, so that all you need to think about are the inputs and outputs. More explicit dependencies probably lead to fewer state-related bugs (and headaches) in the long run.

I'd wholeheartedly embrace this coding style for future Unity projects.

## About me

I work as a senior full-stack engineer by day, and dive into my game development passion by night.

You can check out my blog and YouTube channel, where I create content about Unity and game development:

* **Blog**: https://jasont.co/
* **YouTube**: https://www.youtube.com/nucleartide

Also, please feel free to check out the games I've made:

* **itch.io**: https://nucleartide.itch.io/
